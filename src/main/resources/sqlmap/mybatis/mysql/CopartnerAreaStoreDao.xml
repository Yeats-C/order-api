<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aiqin.mgs.order.api.dao.CopartnerAreaStoreDao">
    <select id = "countStoreByArea" resultType="java.lang.Integer">
    select 
      count(1)
    from copartner_area_store
    where 1=1
    and copartner_area_id = #{copartnerAreaId,jdbcType=VARCHAR}
    </select>
    <insert id="saveCopartnerAreaStore">
        insert into copartner_area_store(
            copartner_area_id,
            store_id,
            store_code,
            store_name,
            memo
        )
        values(
            #{copartnerAreaId},
            #{storeId},
            #{storeCode},
            #{storeName},
            #{memo}
        )
    </insert>
    <select id="selectStoreMainPageList" resultType="com.aiqin.mgs.order.api.domain.copartnerArea.CopartnerAreaStoreList">
        select
         copartner_area_id as copartnerAreaId,
         store_id as storeId,
         store_code as storeCode,
         store_name as storeName
        from copartner_area_store
        where 1=1
        <if test=" copartnerAreaId !=null and copartnerAreaId !='' ">
         and copartner_area_id = #{copartnerAreaId,jdbcType=VARCHAR}
        </if>
    </select>
    <select id="countStoreMainPage" resultType="java.lang.Integer">
        select
         count(1)
        from copartner_area_store
        where 1=1
        <if test=" copartnerAreaId !=null and copartnerAreaId !='' ">
         and copartner_area_id = #{copartnerAreaId,jdbcType=VARCHAR}
        </if>
    </select>
    
    <select id="countStoreByStoreCode" resultType="java.lang.Integer">
        select
         count(1)
        from copartner_area_store
        where 1=1
        <if test=" storeCode !=null and storeCode !='' ">
         and store_code = #{storeCode,jdbcType=VARCHAR}
        </if>
    </select>
    
    <select id="selectPublicAreaStoreList" resultType="com.aiqin.mgs.order.api.domain.copartnerArea.PublicAreaStore">
        select
         store_id as storeId,
         store_code as storeCode,
         store_name as storeName
        from copartner_area_store
        where 1=1
        <if test=" copartnerAreaId !=null and copartnerAreaId !='' ">
         and copartner_area_id = #{copartnerAreaId,jdbcType=VARCHAR}
        </if>
    </select>
    
    <delete id="deleteById">
        delete from copartner_area_store where copartner_area_id = #{copartnerAreaId}
    </delete>
    
    <select id = "selectStoreByStoreCode" resultType="java.lang.Integer">
    select 
      count(1)
    from copartner_area_store
    where 1=1
    and store_code = #{storeCode,jdbcType=VARCHAR}
    </select>
    <select id = "qryInfo" resultType="com.aiqin.mgs.order.api.domain.copartnerArea.CopartnerAreaUp">
    SELECT 
      b.copartner_area_id as copartnerAreaId,b.copartner_area_name as copartnerAreaName
    FROM copartner_area_store a
    LEFT JOIN `copartner_area_info` b ON a.copartner_area_id = b.copartner_area_id
    WHERE 1=1
    and store_code = #{storeCode,jdbcType=VARCHAR}
    </select>
    <select id = "qryAreaByStores" resultType="java.lang.String">
    SELECT 
      distinct copartner_area_id
    FROM copartner_area_store a
    WHERE 1=1
    <if test="storeIds != null">
            and store_id in (
            <foreach collection="storeIds" item="storeId" separator=",">
                '${storeId}'
            </foreach>
            )
    </if>
    </select>
    <select id="slecetTwoCompanyByName"
            parameterType="java.lang.String"
            resultType="com.aiqin.mgs.order.api.domain.copartnerArea.CopartnerAreaDetail">
        SELECT copartner_area_id as copartnerAreaId, copartner_area_name as copartnerAreaName,
               copartner_area_level as copartnerAreaLevel,copartner_area_company as copartnerAreaCompany,
               company_person_id  as companyPersonId, company_person_name as companyPersonName,
               copartner_area_id_up as copartnerAreaIdUp, copartner_area_name_up as copartnerAreaNameUp
        FROM copartner_area_info
        WHERE copartner_area_level = 2
           <if test="copartnerAreaCompany != null and copartnerAreaCompany != ''">
               AND copartner_area_company LIKE CONCAT('%',#{copartnerAreaCompany,jdbcType=VARCHAR},'%')
           </if>
    </select>

    <delete id="deleteByAreaStore">
        delete from copartner_area_store where store_id = #{storeId}
    </delete>
</mapper>

